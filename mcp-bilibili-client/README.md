# 哔哩哔哩MCP智能客户端

这是一个集成了AI智能分析的哔哩哔哩MCP客户端，可以通过自然语言与系统交互。

## 功能特性

### 🤖 AI智能助手
- **自然语言理解**: 通过通义千问AI分析用户意图
- **智能指令解析**: 自动识别用户想要执行的操作
- **步骤化执行**: 将复杂任务分解为多个步骤执行
- **实时反馈**: 每个步骤都有实时状态反馈

### 🎯 支持的操作
1. **设置登录信息**: 自动提取和设置SESSDATA
2. **智能搜索**: 根据关键词搜索视频
3. **批量下载**: 搜索后自动下载所有相关视频
4. **状态查询**: 检查系统和下载状态
5. **错误处理**: 遇到错误自动停止，避免级联失败

## 快速开始

### 1. 启动应用
```bash
cd spring/mcp-bilibili-client
mvn spring-boot:run
```

### 2. 访问界面
- **AI智能助手**: http://localhost:8090/ai-chat.html
- **手动控制台**: http://localhost:8090/index.html

### 3. 使用示例

#### 设置登录信息
```
设置SESSDATA=xxx
```

#### 搜索并下载视频
```
下载JAVA的所有视频
```

#### 简单搜索
```
搜索JAVA的视频
```

#### 检查状态
```
检查系统状态
```

## AI处理流程

1. **用户输入** → 2. **AI意图分析** → 3. **参数提取** → 4. **执行计划** → 5. **MCP服务调用** → 6. **结果展示**

### 执行特点
- ✅ **环环相扣**: 每个步骤都依赖前一步的成功
- ❌ **快速失败**: 遇到错误立即停止，不继续执行
- 🔄 **实时反馈**: 每个步骤都有即时状态更新
- 📝 **详细日志**: 完整记录执行过程和结果

## 技术架构

```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   前端界面       │    │   AI智能分析     │    │  MCP服务调用    │
│ (HTML/JS)      │    │ (通义千问API)    │    │ (Spring AI)    │
├─────────────────┤    ├──────────────────┤    ├─────────────────┤
│ • 聊天界面      │───▶│ • 意图识别       │───▶│ • 视频搜索      │
│ • 实时反馈      │    │ • 参数提取       │    │ • 任务下载      │
│ • 步骤展示      │    │ • 执行规划       │    │ • 状态查询      │
└─────────────────┘    └──────────────────┘    └─────────────────┘
```

## 配置说明

### application.yml
```yaml
spring:
  ai:
    dashscope:
      api-key: ${AI_API_KEY}  # 通义千问API密钥
      chat:
        options:
          model: qwen-plus
    mcp:
      client:
        enabled: true
        stdio:
          connections:
            bilibili-server:
              command: java
              args: [启动参数...]
```

## 依赖要求

- Java 21+
- Spring Boot 3.2.5
- Spring AI 1.0.0
- 通义千问API访问权限
- 哔哩哔哩MCP服务器

## 注意事项

1. **API密钥**: 需要有效的通义千问API密钥
2. **MCP服务器**: 需要哔哩哔哩MCP服务器正常运行
3. **SESSDATA**: 下载功能需要有效的哔哩哔哩登录信息
4. **网络环境**: 确保可以访问相关API服务

## 故障排除

### AI调用失败
- 检查API密钥是否正确
- 确认网络连接正常
- 查看日志中的详细错误信息

### MCP连接失败
- 确认MCP服务器已启动
- 检查服务器路径配置
- 查看服务器运行日志

### 下载失败
- 确认SESSDATA已正确设置
- 检查视频链接或BV号有效性
- 确认有足够的磁盘空间

## 更新日志

### v1.0.0
- ✨ 集成通义千问AI智能分析
- 🎯 支持自然语言指令解析
- 🔗 实现AI与MCP服务无缝连接
- 💻 提供美观的聊天界面
- 📊 添加实时执行步骤展示 